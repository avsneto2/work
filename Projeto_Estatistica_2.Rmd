---
title: "Projeto da Pós Graduação, disciplina Estatística para Cientista de Dados."
author: "Antonio Vieira dos Santos Neto - Cpf 077.523.948-82"
date: "2023-02-21"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk $ set(echo = TRUE)
```

## Introdução

O presente projeto visa demonstrar os conhecimentos nos fundamentos básicos na utilização da linguagem "R", bem como, nos conhecimentos de Estatística.

Neste documento, segue o passo a passo, onde são demonstrados os conhecimentos adquiridos na disciplina.

## Objetivo do Projeto

Demonstrar os conhecimentos adquiridos na disciplina "Estatística para Cientista de Dados", sendo que , através do uso da Linguagem "R", serão feitas diversas análises em uma "Base de evolução de registro de ocorrências do Instituto de Segurança Pública do Rio de Janeiro".

## Preparando o ambiente de análise

Para a criação do ambiente de trabalho foram adotados os seguinte passos :

1-Instalação da linguagem "R" na máquina do aluno. 2-Instalação do Studio "R" na máquina do aluno. 3-Instalação do "GIT" na máquina do aluno. Esta aplicação permite o controle dos versionamentos dos aplicações desenvolvidas. 4-Configuração na nuvem do "GITHUB, criando um repositório"WORK", para arquivo das aplicações desenvolvidas, bem como, controle do versionamento destas.

-   Atenção : As evidências da configuração do ambiente, segue no documento "PROJETO_ESTATISTICA.PDF"

#### Importando bilbiotecas necessárias ao desenvolvimento.

Para suporte no tratamento da base de dados, foram instaladas as bibliotecas a seguir a partir do comando "install.packages".

-   install.packages("tidyverse") - Pacote de ferramentas que tem por objetivo manipulação, exploração e visualização de dados.

-   install.packages("wesanderson") - \*\*\* ATENCAO

-   install.packages("data.table") - Pacote que também tem a função de manipular dados, porém, em algumas situações, permite o tratamento de dados com maior velocidade

-   install.packages("rvest") - Uma das funções do Pacote "rvest" e permitir a leitura de dados a partir de código html, dessa forma o "R" poderá mapear e navegar pela arvore do html.

-   install.packages("robotstxt") - Este pacote fornece funcoes para baixar e analisar arquivos 'robots.txt'.

-   install.packages("knitr") - Este pacote tem a funcao de gerar relatorios dinamicos com R.

-   instal.packages ("dlookr") - Este pacote informações estatísticas sobre dados como visualização, valores ausentes, discrepantes e valores exclusivos e negativos, com o objetivo de entender a distribuição e qualidade dos dados.

-   instal.packages ("readxl") - Este pacote permite a leitura de arquivos excel.

-   instal.packages ("summarytools") - Este pacote permite a análise de dados, como a frequencia de uma determinada variavel;

```{r importando bibliotecas, echo=TRUE}
library(tidyverse)
library(wesanderson)
library(rvest)
library(data.table)
library(robotstxt)
library(knitr)
library(dlookr)
library(readxl)
library(summarytools)

```

#### Definindo o diretório de trabalho para o projeto

Posteriomente, vamos trocar o diretório de referência para o trabalho, mas não vamos deixar essa informação pública para o usuário.

```{r mudando o diretório, echo=FALSE}
setwd("E:/DADOS/VIEIRA/POS GRADUACAO/INFINET/CURSO/WORK_Trabalho/work")
getwd()
```

#### Importando dados

A partir da definição do ambiente, o arquivo "BaseDPEvolucaoMensalCisp.csv", contendo a base de evolução de registro de ocorrencias do Instituto de Segurança Publica do Rio de Janeiro, será importado utilizando a biblioteca rvest, para ler o arquivo "CSV.

```{r importando os dados, echo=TRUE}
Bevolucao.tbl <- readr::read_csv2("BaseDPEvolucaoMensalCisp.csv")
kable(head(Bevolucao.tbl))
```

#### Selecionando dados

Uma vez que os dados foram importados, faremos a seleção das colunas importantes para a análise. Dessa forma, serão selecionados os dados referentes as ocorrencias relacionadas ao Roubo versus apreensao de drogas

```{r selecionando variáveis, echo = TRUE}

Bevolucao.roubos.tbl <- Bevolucao.tbl %>% dplyr::select(CISP,ano,mes_ano,munic,Regiao,apreensao_drogas, roubo_transeunte)
```

#### Selecionando os movimentos referentes aos três últimos anos

Com base na coluna ano, selecionar o movimento dos três últimos anos.

```{r selecionando dados por ano, echo=TRUE}
Bevolucao.roubos.f1.tbl=Bevolucao.roubos.tbl %>% dplyr::filter (ano =='2022'| ano =='2021' | ano =='2020')
```

#### Agrupando por regiao, munic, ano e mes/ano.

Vamos agrupar os dados por regiao, municipio e ano,com o objetivo de entender o movimento das ocorrencias de roubo no periodo.

```{r agrupando dados por regiao, munic, ano, echo=TRUE}
Bevolucao.roubos.f2.tbl <- Bevolucao.roubos.f1.tbl %>% dplyr::group_by(Regiao, munic, ano, mes_ano) %>% dplyr::summarise(roubo_transeunte_sum = sum(roubo_transeunte), apreensao_drogas_sum = sum(apreensao_drogas))

```

#### Convertendo dados da coluna "mes_ano" e retirando caracter com acento.

Os dados da coluna "mes_ano" encontram-se no formato "aaaammm" e deverão ser convertidos para o formato "aaaa-mm". Os dados da coluna "munic" e "Regiao" deverao ter acentos retirados.

```{r convertendo dados pop, echo=TRUE}
Bevolucao.roubos.f3.tbl <-Bevolucao.roubos.f2.tbl %>% dplyr::mutate(mes_ano = stringr::str_replace_all(mes_ano, "\\m", "-"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f3.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Arma��o dos B�zios", "Armacao dos Buzios"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Comendador Levy Gasparian;Areal;Tr�s Rios", "Comendador Levy Gasparian;Areal;Tres Rios"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Concei��o de Macab�", "Conceicao de Macabu"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Itabora�", "Itaborai"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Itagua�", "Itaguai"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Itaperuna;S�o Jos� de Ub�","Itaperuna;Sao Jose de Uba"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Laje do Muria�", "Laje do Muriae"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Maca�", "Macae"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Mag�", "Mage"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Maric�", "Marica"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Nil�polis","Nilopolis"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Nova Igua�u", "Nova Iguacu"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Pira�","Pirai"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Porci�ncula","Porciuncula"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Quissam�;Carapebus", "Quisama:Carapebus"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Santo Ant�nio de P�dua;Aperib�","Santo Antonio de Padua;Aperibe"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"S�o Fid�lis", "Sao Fidelis"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"S�o Gon�alo", "Sao Goncalo"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"S�o Jo�o da Barra", "Sao Joao da Barra"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"S�o Jo�o de Meriti", "Sao Joao de Meriti"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"S�o Jos� do Vale do Rio Preto","Sao Jose do Vale do Rio Preto"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"S�o Sebasti�o do Alto", "Sao Sebastiao do Alto"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Serop�dica", "Seropedica"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Tangu�","Tangua"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Teres�polis", "Teresopolis"))


Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Valen�a","Valenca"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Niter�i", "Niteroi"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Para�ba do Sul","Paraiba do Sul"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"Petr�polis","Petropolis"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"S�o Pedro da Aldeia","Sao Pedro da Aldeia"))

Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(munic = stringr::str_replace_all(munic,"S�o Francisco de Itabapoana","Sao Francisco de Itabopoana"))


Bevolucao.roubos.f4.tbl <-Bevolucao.roubos.f4.tbl %>% dplyr::mutate(Regiao = stringr::str_replace_all(Regiao,"Grande Niter�i","Grande Niteroi"))

```

## Iniciando a analise dos dados

#### Identicando os tipos de variaveis

Para identificar os tipos de cada variável na base, vamos utilizar o pacote "dlookr".

```{r identificando os tipos de variáveis, echo = TRUE}
Bevolucao.roubos.f4.tbl%>% dlookr::diagnose()
```

Na tabela "Bevolucao.roubos.f4.tbl" e possivel identificar as variaveis do tipo QUALITATIVAS NOMINAIS que são: 

- Regiao = Regiao 
- munic   = Municipio 
- ano    = ano relacionado ao registro das ocorrencias. 
- mes_ano= mes e ano relacionado ao registro das ocorrencias


Na tabela "Bevolucao.roubos.f4.tbl" e possivel identificar as variaveis do tipo QUANTITATIVAS DISCRETAS que são: 

- roubo_transeunte_sum
- apreensao_drogas_sum


#### Identicando a frequencia de variaveis 

Para o próximo passo irei analiser a frequencia das variaveis. 

- Frequencia da variavel "Regiao": 

```{r frequências de uma variável, echo = TRUE}
Bevolucao.roubos.f4.tbl %>% dplyr::select(Regiao) %>% summarytools::freq()
```
 
######################################################################################################################## 

#### ATENCAO : IDENTIFICAR O TIPO DE VARIAVEIS

#### IDENTIFICANDO O TIPO DE VARIAVEIS

Iniciando a análise dos dados, através do comando diagnose, será identificado o tipo de cada variável.

#### Gerando Grafico

Gerando gráfico para acompanhamento das ocorrencias de roubo por regiao, nos tres ultimos anos

```{r plotando a informacao por regiao e ano, echo = TRUE}

ggplot(Bevolucao.roubos.f3.tbl, aes(x = Regiao, y = roubo_transeunte_sum)) + facet_wrap(~ano)
```
