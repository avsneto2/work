---
title: "Projeto-Pós Graduação, Analise Exploratória de Dados."
author: "Antonio Vieira dos Santos Neto - Cpf 077.523.948-82"
date: "2023-04-11"
output:
 
  bookdown::pdf_document2:
    latex_engine: lualatex
  tufte::tufte_handout:
    latex_engine: xelatex
df_print: kable
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk $ set(echo = TRUE)
```

# Introdução

O presente projeto visa demonstrar os conhecimentos nos fundamentos
básicos na utilização da linguagem "R", bem como, nos conhecimentos de
Estatística.

Neste documento, segue o passo a passo, onde são demonstrados os
conhecimentos adquiridos na disciplina, "ANALISE EXPLORATÓRIA DE DADOS".

# Objetivo do Projeto

Demonstrar os conhecimentos adquiridos na disciplina "ANALISE
EXPLORATÓRIA DE DADOS", sendo que , através do uso da Linguagem "R",
serão feitas diversas análises em uma "Base de PIB real por países,
extraida do livro do Stock & Watson, apresentada em papaer do
Acemoglu. - A análise visa, demonstrar o crescimento do PIB nos 3
ultimos anos de 5 paises europeus e 5 paises da América do Sul.

# Preparando o ambiente de análise

Para a criação do ambiente de trabalho foram adotados os seguinte passos
:

-   1-Instalação da linguagem "R" na máquina do aluno.

-   2-Instalação do Studio "R" na máquina do aluno.

-   3-Instalação do "GIT" na máquina do aluno. Esta aplicação permite o
    controle dos versionamentos dos aplicações desenvolvidas.

-   4-Configuração na nuvem do "GITHUB, criando um repositório"WORK",
    para arquivo das aplicações desenvolvidas, bem como, controle do
    versionamento destas.

-   Atenção:

-   1 - As evidências da configuração do ambiente, segue no documento
    "Antonio VSNeto_Analise_Expl_Dados_evidencias.pdf"

-   2 - O caminho para o Github do aluno e´:
    <https://github.com/avsneto2/work.git>

-   3- Os arquivos do projeto se encontram na branch : Anal_Exploratoria

# Importando bibliotecas necessárias ao desenvolvimento. -

Para suporte no tratamento da base de dados, foram instaladas as
bibliotecas a seguir a partir do comando "install.packages".

-   install.packages("tidyverse") - Pacote de ferramentas que tem por
    objetivo manipulação, exploração e visualização de dados.

-   install.packages("data.table") - Pacote que também tem a função de
    manipular dados, porém, em algumas situações, permite o tratamento
    de dados com maior velocidade

-   install.packages("rvest") - Uma das funções do Pacote "rvest" e
    permitir a leitura de dados a partir de código html, dessa forma o
    "R" poderá mapear e navegar pela arvore do html.

-   install.packages("robotstxt") - Este pacote fornece funcoes para
    baixar e analisar arquivos 'robots.txt'.

-   install.packages("knitr") - Este pacote tem a funcao de gerar
    relatorios dinamicos com R.

-   install.packages ("dlookr") - Este pacote informações estatísticas
    sobre dados como visualização, valores ausentes, discrepantes e
    valores exclusivos e negativos, com o objetivo de entender a
    distribuição e qualidade dos dados.

-   install.packages ("readxl") - Este pacote permite a leitura de
    arquivos excel.

-   install.packages ("summarytools") - Este pacote permite a análise de
    dados, como a frequencia de uma determinada variavel;

-   install.packages ("ggplot2") - Este pacote permite o desenvolvimento
    de graficos;

-   install.packages ("fitdistrplus") - Pacote com várias funções para
    ajudar no ajuste de uma distribuição paramétrica a dados não
    censurados ou censurados.

-   install.packages ("Amelia") - Pacote R para a imputação múltipla de
    dados incompletos multivariados. Ele usa um algoritmo que combina
    bootstrapping e o algoritmo EM para extrair dados posteriores dos
    dados ausentes. O pacote Amelia inclui transformações de
    normalização, priorizações em nível de célula e métodos para lidar
    com dados transversais de séries temporais.

-   install.packages ("mice") - Pacote R que ajuda a imputar valores
    ausentes com valores de dados plausíveis. Esses valores plausíveis
    são extraídos de uma distribuição projetada especificamente para
    cada ponto de dados ausente

-   install.packages ("corrplot") - Pacote R que fornece uma ferramenta
    exploratória visual na matriz de correlação que oferece suporte à
    reordenação automática de variáveis para ajudar a detectar padrões
    ocultos entre as variáveis.

-   install.packages ("ggpubr") - Pacote R que facilita a criação de
    belos gráficos baseados em ggplot2 para pesquisadores com
    experiência em programação não avançada.

-   install.packages ("data.table") - Amplamente usado para agregação
    rápida de grandes conjuntos de dados, adição/atualização/remoção de
    colunas de baixa latência, junções ordenadas mais rápidas e um
    leitor de arquivos rápido.

-   install.packages ("plm") - Pacote para R que pretende simplificar a
    estimação de modelos de painéis lineares. O PLM fornece funções para
    estimar uma ampla variedade de modelos e fazer inferências
    (robustas).

-   install.packages ("shiny") - pacote R que facilita a criação de
    aplicativos da Web interativos diretamente do R. Você pode hospedar
    aplicativos independentes em uma página da Web ou incorporá-los em
    documentos R Markdown ou criar painéis.

-   install.packages ("flexdashboard") - pode criar um documento a
    partir do RStudio usando a caixa de diálogo Arquivo -\> Novo arquivo
    -\> R Markdown e escolhendo um modelo "Flex Dashboard"

# Carregando bibliotecas

```{r importando bibliotecas, echo=FALSE}
library(tidyverse)
library(rvest)
library(data.table)
library(robotstxt)
library(knitr)
library(dlookr)
library(readxl)
library(summarytools)
library(ggplot2)
library(fitdistrplus)
library(readr)
library(kableExtra)
library("Amelia")
library("mice")
library("corrplot")
library("ggpubr")
library("data.table")
library("plm")
library("shiny")
library("flexdashboard")

```

# Definindo o diretório de trabalho para o projeto

Posteriomente, vamos trocar o diretório de referência para o trabalho,
mas não vamos deixar essa informação pública para o usuário.

```{r mudando o diretório, echo=FALSE}
setwd("E:/DADOS/VIEIRA/POS GRADUACAO/INFINET/CURSO/WORK_TRABALHO_2")
getwd()
```

# Importando dados

A partir da definição do ambiente, o arquivo "income_democracy.xlsx",
contendo a base de pib real por países, será importada utilizando a
biblioteca rvest, para ler o arquivo xlsx.

```{r importando os dados, echo=TRUE}
## Bevolucao.tbl <- readr::read_csv2("BaseDPEvolucaoMensalCisp.csv")
## Bevolucao.tbl <- readr::read_csv2("BaseDPEvolucaoMensalCisp.csv", locale=locale(encoding="latin1"))
## kable(head(Bevolucao.tbl, 5), booktabs = TRUE) %>%  kable_styling(font_size = 10)

income <- readxl::read_excel("income_democracy.xlsx")
names(income)[c(1:2, 4:length(names(income)))] <- c("pais", "ano", "Log.pib.real", "Log.populacao", "fracao.pop.0_14", "fracao.pop.15_19", "fracao.pop.30_44", "fracao.pop.45_59","fracao.pop.60_mais", "educ.adultos", "idade.mediana", "pais.idx")

```

# Selecionando dados

## Selecionando - variaveis

Considerando o espaço amostral importado, para fins do trabalho será
selecionado um evento contendo 5 (cinco) países europeus e 5 (cinco) paises da
America do Sul, considerando os anos de  1995 e 2000.

```{r selecionando variáveis, echo = TRUE}

income.arq1 <- income %>% dplyr::select(pais.idx, pais,ano,Log.pib.real,Log.populacao, educ.adultos, fracao.pop.0_14,fracao.pop.15_19,fracao.pop.30_44,fracao.pop.45_59,fracao.pop.60_mais, idade.mediana, pais.idx)
kable(head(income.arq1, 5), booktabs = TRUE) %>%  kable_styling(font_size = 10)
```

## Selecionando - dados referentes aos anos 1995 e 2000.

Com base na coluna ano, selecionar o movimento dos dois últimos anos(1995 e 2000).

```{r selecionando dados por ano 1995, echo=TRUE}
income.arq2.1995 <- income.arq1  %>% dplyr::filter (ano =='1995')
kable(head(income.arq2.1995, 5), booktabs = TRUE) %>%  kable_styling(font_size = 10)

```

```{r selecionando dados por ano  2000, echo=TRUE}
income.arq2.2000 <- income.arq1  %>% dplyr::filter (ano =='2000')
kable(head(income.arq2.2000, 5), booktabs = TRUE) %>%  kable_styling(font_size = 10)

```

## Selecionando 1995/2000 + Paises Europa/America Suls 

```{r selecionando anos 19952000, echo=TRUE}
income.arq3 <- income.arq1  %>% dplyr::filter (ano =='1995'| ano=='2000' )
kable(head(income.arq3, 5), booktabs = TRUE) %>%  kable_styling(font_size = 10)

```

```{r selecionando anos 19952000euam, echo=TRUE}
income.arq3 <- income.arq3  %>% dplyr::filter (ano =='1995'| ano=='2000' )%>% dplyr::filter (pais =='Italy'| pais =='France' | pais =='Germany' | pais =='Brazil' | pais == 'Argentina' | pais == 'Bolivia'| pais == 'Germany, West' | pais == 'Spain' | pais == 'Chile' | pais == 'Uruguay')
kable(head(income.arq3, 5), booktabs = TRUE) %>%  kable_styling(font_size = 10)

```

## Selecionando 1995/2000 - dados referentes aos paises : Europeus = Italy, France, Germany, Germany.West, Spain / Am.Sul = Brazil, Argentina, Paraguay, Chile, Uruguay


```{r selecionando dados por pais , echo=TRUE}
income.arq3.1995 <- income.arq2.1995  %>% dplyr::filter (pais =='Italy'| pais =='France' | pais =='Germany' | pais =='Brazil' | pais == 'Argentina' | pais == 'Bolivia'| pais == 'Germany, West' | pais == 'Spain' | pais == 'Chile' | pais == 'Uruguay')
kable(head(income.arq3.1995, 5), booktabs = TRUE) %>%  kable_styling(font_size = 10)

income.arq3.2000 <- income.arq2.2000  %>% dplyr::filter (pais =='Italy'| pais =='France' | pais =='Germany' | pais =='Brazil' | pais == 'Argentina' | pais == 'Bolivia'| pais == 'Germany, West' | pais == 'Spain' | pais == 'Chile' | pais == 'Uruguay')
kable(head(income.arq3.2000, 5), booktabs = TRUE) %>%  kable_styling(font_size = 10)
```


## Separando bases -eur  - 1995/2000 

```{r selecionando dados por pais2, echo=TRUE}
 
income.arq3.1995.eur <- income.arq3.1995  %>% dplyr::filter (pais =='Italy'| pais =='France' | pais =='Germany' | pais == 'Germany, West' | pais == 'Spain')
kable(head(income.arq3.1995.eur , 5), booktabs = TRUE) %>%  kable_styling(font_size = 10)

income.arq3.2000.eur <- income.arq3.2000  %>% dplyr::filter (pais =='Italy'| pais =='France' | pais =='Germany' | pais == 'Germany, West' | pais == 'Spain')
kable(head(income.arq3.2000.eur , 5), booktabs = TRUE) %>%  kable_styling(font_size = 10)

```

## Separando bases Am.Sul - 1995/2000 

```{r selecionando dados por pais3, echo=TRUE} 

income.arq3.1995.amsul <- income.arq3.1995  %>% dplyr::filter (pais =='Brazil' | pais == 'Argentina' | pais == 'Bolivia'| pais == 'Chile' | pais == 'Uruguay' )
kable(head(income.arq3.1995.amsul, 5), booktabs = TRUE) %>%  kable_styling(font_size = 10)

income.arq3.2000.amsul <- income.arq3.2000  %>% dplyr::filter (pais =='Brazil' | pais == 'Argentina' | pais == 'Bolivia'| pais == 'Chile' | pais == 'Uruguay' )
kable(head(income.arq3.1995.amsul, 5), booktabs = TRUE) %>%  kable_styling(font_size = 10)

```

# Iniciando a analise dos dados

## Identificando os tipos de variaveis

Para identificar os tipos de cada variável na base, vamos utilizar o
pacote "dlookr"e a função "diagnose".

```{r identificando os tipos de variáveis, echo = TRUE, warning=FALSE, results='asis'}
income.arq3 %>% dlookr::diagnose()  %>% kable()
```

A partir do função diagnose é possível identificar o tipo de cada
variável do espaço amostral, sendo:

-   pais.idx           - Variavel ordinal 
-   pais               - Variavel qualitativa  
-   ano                - variavel ordinal
-   log.pib.real       - variavel quantitativa continua
-   log.populacao      - variavel quantitativa continua 
-   educ.adultos       - variavel quantitativa continua
-   fracao.pop.0_14    - variavel quantitativa continua
-   fracao.pop.15_19   - variavel quantitativa continua
-   fracao.pop.30_44   - variavel quantitativa continua
-   fracao.pop.45_59   - variavel quantitativa continua
-   fracao.pop.60_mais - variavel quantitativa continua
-   idade mediana      - variavel quantitativa continua 


## Análise descritiva - 1995 

Considerando as variaveis continuas, vamos analisar a centralidade dos
dados, bem como a presença de outliers. Será utilizada a função descr do
pacote summarytools, para esta análise, considerando o dados referente ao ano de 1995.  

```{r desc variavel pibreal1995, echo = TRUE, warning = FALSE, results='asis'}
income.arq3.1995 %>% dplyr::select(Log.pib.real) %>% summarytools::descr()
```

Com base o indicador skewness acima, em -0.38 e sabendo-se que valores
de skew na faixa de -0.5 \< skew \< 0.5, podemos afirmar que trata-se de
um caso fracamente simetrico

Pode-se observar uma leve diferença entre o valor da media (Mean = 9.14)
e Mediana (Median =8.89), o que também remete a uma simetria entre os
valores, sem a presença de outliers significativos. 


```{r desc variavel logpop1995, echo = TRUE, warning = FALSE, results='asis'}
income.arq3.1995 %>% dplyr::select(Log.populacao) %>% summarytools::descr()
```

Com base o indicador skewness acima, em -0.48 e sabendo-se que valores
de skew na faixa de -0.5 \< skew \< 0.5, podemos afirmar que trata-se de
um caso fracamente simetrico 

Pode-se observar uma leve diferença entre o valor da media (Mean = 10.26)
e Mediana (Median =10.57), o que também remete a uma simetria entre os
valores, sem a presença de outliers signficativos.


```{r desc variavel educad1995, echo = TRUE, warning = FALSE, results='asis'}
income.arq3.1995 %>% dplyr::select(educ.adultos) %>% summarytools::descr()
```

Com base o indicador skewness acima, em -0.24 e sabendo-se que valores
de skew na faixa de -0.5 \< skew \< 0.5, podemos afirmar que trata-se de
um caso fracamente simetrico 

Pode-se observar uma leve diferença entre o valor da media (Mean = 6.55)
e Mediana (Median =6.69), o que também remete a uma simetria entre os
valores, sem a presença de outliers signficativos.


```{r desc variavel fp0141995, echo = TRUE, warning = FALSE, results='asis'}
income.arq3.1995 %>% dplyr::select(fracao.pop.0_14) %>% summarytools::descr()
```

Com base o indicador skewness acima, em 0.27 e sabendo-se que valores
de skew na faixa de -0.5 \< skew \< 0.5, podemos afirmar que trata-se de
um caso fracamente simetrico 

Pode-se observar uma leve diferença entre o valor da media (Mean = 0.26)
e Mediana (Median =0.26), o que também remete a uma simetria entre os
valores, sem a presença de outliers. 


```{r desc variavel fp15191995, echo = TRUE, warning = FALSE, results='asis'}
income.arq3.1995 %>% dplyr::select(fracao.pop.15_19) %>% summarytools::descr()
```

Com base o indicador skewness acima, em 0.44 e sabendo-se que valores
de skew na faixa de -0.5 \< skew \< 0.5, podemos afirmar que trata-se de
um caso fracamente simetrico

Pode-se observar uma leve diferença entre o valor da media (Mean = 0.25)
e Mediana (Median =0.24), o que também remete a uma simetria entre os
valores, sem a presença de outliers significativos. 



```{r desc variavel fp30441995, echo = TRUE, warning = FALSE, results='asis'}
income.arq3.1995 %>% dplyr::select(fracao.pop.30_44) %>% summarytools::descr()
```

Com base o indicador skewness acima, em -0.47 e sabendo-se que valores
de skew na faixa de -0.5 \< skew \< 0.5, podemos afirmar que trata-se de
um caso fracamente simetrico

Pode-se observar uma leve diferença entre o valor da media (Mean = 0.20)
e Mediana (Median =0.20), o que também remete a uma simetria entre os
valores, sem a presença de outliers.


```{r desc variavel fp45591995, echo = TRUE, warning = FALSE, results='asis'}
income.arq3.1995 %>% dplyr::select(fracao.pop.45_59) %>% summarytools::descr()
```

Com base o indicador skewness acima, em -0.06 pode-se afirmar que a distribuição neste caso é normal. 

Pode-se observar uma leve diferença entre o valor da media (Mean = 0.15)
e Mediana (Median =0.16), o que também remete a uma simetria entre os
valores, sem a presença de outliers significativos. 


```{r desc variavel fp60m1995, echo = TRUE, warning = FALSE, results='asis'}
income.arq3.1995 %>% dplyr::select(fracao.pop.60_mais) %>% summarytools::descr()
```

Com base o indicador skewness acima, em -0.37 e sabendo-se que valores
de skew na faixa de -0.5 \< skew \< 0.5, podemos afirmar que trata-se de
um caso fracamente simetrico

Pode-se observar uma leve diferença entre o valor da media (Mean = 0.15)
e Mediana (Median =0.16), o que também remete a uma simetria entre os
valores, sem a presença de outliers.


```{r desc variavel idmed1995, echo = TRUE, warning = FALSE, results='asis'}
income.arq3.1995 %>% dplyr::select(idade.mediana) %>% summarytools::descr()
```

Com base o indicador skewness acima, em -0.27 e sabendo-se que valores
de skew na faixa de -0.5 \< skew \< 0.5, podemos afirmar que trata-se de
um caso fracamente simetrico

Pode-se observar uma diferença entre o valor da media (Mean = 29.89)
e Mediana (Median =30.70), o que também remete a uma simetria entre os
valores, sem a presença significativa de outliers.


Conclusão : Para os dados analisados em 1995, de forma geral, os dados tendem a uma distribuição normal, sem a presença significativa de outliers 



## Análise descritiva - 2000

Considerando as variaveis continuas, vamos analisar a centralidade dos
dados, bem como a presença de outliers. Será utilizada a função descr do
pacote summarytools, para esta análise, considerando o dados referente ao ano de 2000.  

```{r desc variavel pibreal2000, echo = TRUE, warning = FALSE, results='asis'}
income.arq3.2000 %>% dplyr::select(Log.pib.real) %>% summarytools::descr()
```

Com base o indicador skewness acima, em -0.72 e sabendo-se que valores
de skew na faixa de 0.5 \< skew \< 1, podemos afirmar que trata-se de
um caso assimetria moderada. 

Pode-se observar uma leve diferença entre o valor da media (Mean = 9.28)
e Mediana (Median = 9.24), o que também remete a uma simetria entre os
valores, sem a presença de outliers significativos. 


```{r desc variavel logpop2000, echo = TRUE, warning = FALSE, results='asis'}
income.arq3.2000 %>% dplyr::select(Log.populacao) %>% summarytools::descr()
```

Com base o indicador skewness acima, em -0.47 e sabendo-se que valores
de skew na faixa de -0.5 \< skew \< 0.5, podemos afirmar que trata-se de
um caso fracamente simetrico 

Pode-se observar uma leve diferença entre o valor da media (Mean = 10.31)
e Mediana (Median =10.58), o que também remete a uma simetria entre os
valores, sem a presença de outliers signficativos.


```{r desc variavel educad2000, echo = TRUE, warning = FALSE, results='asis'}
income.arq3.2000 %>% dplyr::select(educ.adultos) %>% summarytools::descr()
```

Com base o indicador skewness acima, em -0.18 e sabendo-se que valores
de skew na faixa de -0.5 \< skew \< 0.5, podemos afirmar que trata-se de
um caso fracamente simetrico 

Pode-se observar uma leve diferença entre o valor da media (Mean = 6.96)
e Mediana (Median =6.88), o que também remete a uma simetria entre os
valores, sem a presença de outliers signficativos.


```{r desc variavel fp0142000, echo = TRUE, warning = FALSE, results='asis'}
income.arq3.2000 %>% dplyr::select(fracao.pop.0_14) %>% summarytools::descr()
```

Com base o indicador skewness acima, em 0.35 e sabendo-se que valores
de skew na faixa de -0.5 \< skew \< 0.5, podemos afirmar que trata-se de
um caso fracamente simetrico 

Pode-se observar uma leve diferença entre o valor da media (Mean = 0.25)
e Mediana (Median =0.25), o que também remete a uma simetria entre os
valores, sem a presença de outliers. 


```{r desc variavel fp15192000, echo = TRUE, warning = FALSE, results='asis'}
income.arq3.2000 %>% dplyr::select(fracao.pop.15_19) %>% summarytools::descr()
```

Com base o indicador skewness acima, em -0.16 e sabendo-se que valores
de skew na faixa de -0.5 \< skew \< 0.5, podemos afirmar que trata-se de
um caso fracamente simetrico

Pode-se observar uma leve diferença entre o valor da media (Mean = 0.24)
e Mediana (Median =0.25), o que também remete a uma simetria entre os
valores, sem a presença de outliers significativos. 



```{r desc variavel fp30442000, echo = TRUE, warning = FALSE, results='asis'}
income.arq3.2000 %>% dplyr::select(fracao.pop.30_44) %>% summarytools::descr()
```

Com base o indicador skewness acima, em -0.64 e sabendo-se que valores
de skew na faixa de -0.5 \< skew \< 0.5, podemos afirmar que trata-se de
um caso fracamente simetrico

Pode-se observar uma leve diferença entre o valor da media (Mean = 0.21)
e Mediana (Median =0.22), o que também remete a uma simetria entre os
valores, sem a presença de outliers.


```{r desc variavel fp45592000, echo = TRUE, warning = FALSE, results='asis'}
income.arq3.2000 %>% dplyr::select(fracao.pop.45_59) %>% summarytools::descr()
```
Com base o indicador skewness acima, em -0.12 e sabendo-se que valores
de skew na faixa de -0.5 \< skew \< 0.5, podemos afirmar que trata-se de
um caso fracamente simetrico

Pode-se observar uma leve diferença entre o valor da media (Mean = 0.15)
e Mediana (Median =0.15), o que também remete a uma simetria entre os
valores, sem a presença de outliers.



```{r desc variavel fp60m2000, echo = TRUE, warning = FALSE, results='asis'}
income.arq3.2000 %>% dplyr::select(fracao.pop.60_mais) %>% summarytools::descr()
```

Com base o indicador skewness acima, em -0.28 e sabendo-se que valores
de skew na faixa de -0.5 \< skew \< 0.5, podemos afirmar que trata-se de
um caso fracamente simetrico

Pode-se observar uma leve diferença entre o valor da media (Mean = 0.15)
e Mediana (Median =0.17), o que também remete a uma simetria entre os
valores, sem a presença de outliers.


```{r desc variavel idmed2000, echo = TRUE, warning = FALSE, results='asis'}
income.arq3.2000 %>% dplyr::select(idade.mediana) %>% summarytools::descr()
```

Com base o indicador skewness acima, em -0.26 e sabendo-se que valores
de skew na faixa de -0.5 \< skew \< 0.5, podemos afirmar que trata-se de
um caso fracamente simetrico

Pode-se observar uma diferença entre o valor da media (Mean = 30.86)
e Mediana (Median =31.10), o que também remete a uma simetria entre os
valores, sem a presença significativa de outliers.


Conclusão : Para os dados analisados em 2000, de forma geral, os dados tendem a uma distribuição normal, sem a presença significativa de outlier. 






## Analisando a matriz de correlação - Grafico de scatter matrix - 1995 


```{r Correl1995 , echo = TRUE}
kable(cor(income.arq3.1995 %>% dplyr::filter(!is.na(Log.pib.real) ) %>% dplyr::select(ano, Log.pib.real, Log.populacao, educ.adultos,fracao.pop.0_14, fracao.pop.15_19, fracao.pop.30_44,fracao.pop.45_59,fracao.pop.60_mais, idade.mediana)))
```


Na analise acima é possivel verificar maior correlação entre as seguintes variaveis: 

- Log.pib.real x fracao.pop.30_44      = 0.87
- log.pib.real x fracao.pop.45_59      = 0.87
- log.pib.real x fracao.pop.60_mais    = 0.91
- log.pib.real x idade.mediana         = 0.95
- fracao.pop.60_mais x idade.mediana   = 0.98 


## Analisando a matriz de correlação - Grafico de scatter matrix - 2000 


```{r Correl2000 , echo = TRUE}
kable(cor(income.arq3.2000 %>% dplyr::filter(!is.na(Log.pib.real) ) %>% dplyr::select(ano, Log.pib.real, Log.populacao, educ.adultos,fracao.pop.0_14, fracao.pop.15_19, fracao.pop.30_44,fracao.pop.45_59,fracao.pop.60_mais, idade.mediana)))
```


Na analise acima é possivel verificar maior correlação entre as seguintes variaveis: 

- Log.pib.real x fracao.pop.30_44      = 0.87
- log.pib.real x fracao.pop.45_59      = 0.87
- log.pib.real x fracao.pop.60_mais    = 0.91
- log.pib.real x idade.mediana         = 0.95
- fracao.pop.60_mais x idade.mediana   = 0.97 


Analisando Scatter - 1995

```{r analisando scatter 1995 1 , echo = TRUE, results='asis'}
income.arq3.1995 %>% dplyr::filter(!is.na(Log.pib.real)) %>% dplyr::select(Log.pib.real, fracao.pop.30_44) %>% ggplot(aes(x=Log.pib.real, y =fracao.pop.30_44)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + theme_classic()
```


```{r analisando scatter 1995 2 , echo = TRUE, results='asis'}
income.arq3.1995 %>% dplyr::filter(!is.na(Log.pib.real)) %>% dplyr::select(Log.pib.real, fracao.pop.45_59) %>% ggplot(aes(x=Log.pib.real, y =fracao.pop.45_59)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + theme_classic()
```


```{r analisando scatter 1995 3 , echo = TRUE, results='asis'}
income.arq3.1995 %>% dplyr::filter(!is.na(Log.pib.real)) %>% dplyr::select(Log.pib.real, fracao.pop.60_mais) %>% ggplot(aes(x=Log.pib.real, y =fracao.pop.60_mais)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + theme_classic()
```


```{r analisando scatter 1995 4 , echo = TRUE, results='asis'}
income.arq3.1995 %>% dplyr::filter(!is.na(Log.pib.real)) %>% dplyr::select(Log.pib.real, idade.mediana) %>% ggplot(aes(x=Log.pib.real, y =idade.mediana)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + theme_classic()
```


```{r analisando scatter 1995 5 , echo = TRUE, results='asis'}
income.arq3.1995 %>% dplyr::filter(!is.na(idade.mediana)) %>% dplyr::select(idade.mediana,fracao.pop.60_mais) %>% ggplot(aes(x=idade.mediana, y =fracao.pop.60_mais)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + theme_classic()
```



Analisando Scatter - 2000

```{r analisando scatter 2000 1 , echo = TRUE, results='asis'}
income.arq3.2000 %>% dplyr::filter(!is.na(Log.pib.real)) %>% dplyr::select(Log.pib.real, fracao.pop.30_44) %>% ggplot(aes(x=Log.pib.real, y =fracao.pop.30_44)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + theme_classic()
```


```{r analisando scatter 2000 2 , echo = TRUE, results='asis'}
income.arq3.2000 %>% dplyr::filter(!is.na(Log.pib.real)) %>% dplyr::select(Log.pib.real, fracao.pop.45_59) %>% ggplot(aes(x=Log.pib.real, y =fracao.pop.45_59)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + theme_classic()
```


```{r analisando scatter 2000 3 , echo = TRUE, results='asis'}
income.arq3.2000 %>% dplyr::filter(!is.na(Log.pib.real)) %>% dplyr::select(Log.pib.real, fracao.pop.60_mais) %>% ggplot(aes(x=Log.pib.real, y =fracao.pop.60_mais)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + theme_classic()
```


```{r analisando scatter 2000 4 , echo = TRUE, results='asis'}
income.arq3.2000 %>% dplyr::filter(!is.na(Log.pib.real)) %>% dplyr::select(Log.pib.real, idade.mediana) %>% ggplot(aes(x=Log.pib.real, y =idade.mediana)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + theme_classic()
```


```{r analisando scatter 20005 , echo = TRUE, results='asis'}
income.arq3.2000 %>% dplyr::filter(!is.na(idade.mediana)) %>% dplyr::select(idade.mediana,fracao.pop.60_mais) %>% ggplot(aes(x=idade.mediana, y =fracao.pop.60_mais)) + geom_point() + geom_smooth(method = "lm", se = FALSE) + theme_classic()
```





## Verificando distribuição normal

Deve-se entender como DISTRIBUIÇÃO NORMAL, uma função de probabilidade
cujo gráfico descreve uma curva no formato de sino. Também conhecida
como GAUSSIANA. Dessa forma, podemos observar uma simetria no formato da
curva do gráfico, bem como, valores muito próximos entre MÉDIA e
MEDIANA.

## Criando um Histograma

Através do histrograma abaixo, será possível ilustrar a distribuição do
evento amostral considerado neste trabalho, observando a concentração de
dados, bem como, a eventual presença de outliers.

A escolha do numero de bins foi livre e considerando que os eventos
amostrais avaliados, valores de media/media e 1 e 3 quartil. 

Até o momento tem um simetria moderada, Também no gráfico,
não observa-se a presença significativa de outliers, confirmando o resultado das
funções summarytools::descr(), executadas acima.

histrograma - ano 1995 

```{r hlpbr1995 , echo = TRUE}
income.arq3.1995 %>% dplyr::filter(!is.na(Log.pib.real)) %>% dplyr::select(Log.pib.real) %>% ggplot(aes(x=Log.pib.real))+geom_histogram(aes(y = after_stat(density)) ,bins = 4, fill = 'lightblue') + xlab('Log.pib.real') + ylab('Densidade de Frequência') + geom_vline(xintercept=c(median(income.arq3.1995$Log.pib.real), mean(income.arq3.1995$Log.pib.real))) + annotate("text", x=median(income.arq3.1995$Log.pib.real) + 0.3, y=0.05, label="Mediana", angle=90) + annotate("text", x=mean(income.arq3.1995$Log.pib.real) + 0.3, y=0.05, label="Média", angle=90) + theme_classic()
```

histograma - ano 2000 

```{r hlpbr2000 , echo = TRUE}
income.arq3.2000 %>% dplyr::filter(!is.na(Log.pib.real)) %>% dplyr::select(Log.pib.real) %>% ggplot(aes(x=Log.pib.real))+geom_histogram(aes(y = after_stat(density)) ,bins = 3, fill = 'lightblue') + xlab('Log.pib.real') + ylab('Densidade de Frequência') + geom_vline(xintercept=c(median(income.arq3.2000$Log.pib.real), mean(income.arq3.2000$Log.pib.real))) + annotate("text", x=median(income.arq3.2000$Log.pib.real) + 0.3, y=0.05, label="Mediana", angle=90) + annotate("text", x=mean(income.arq3.2000$Log.pib.real) + 0.3, y=0.05, label="Média", angle=90) + theme_classic()
```




 
## Criando um grafico Q-Q (qqplot)  

QQ-plot - 1995 

```{r qqeur , echo = TRUE}
qqnorm ( income.arq3.1995$Log.pib.real, pch = 1 , frame = FALSE )
qqline (income.arq3.1995$Log.pib.real)
```


QQ-plot - 2000 


```{r qqams , echo = TRUE}
qqnorm ( income.arq3.2000$Log.pib.real, pch = 1 , frame = FALSE )
qqline (income.arq3.2000$Log.pib.real)

```

## Executando teste Shapiro-Wilk

Shapiro - 1995 

```{r shapiro wilk eur, echo = FALSE}
shapiro.test(income.arq3.1995$Log.pib.real)

```

Shapiro - 2000

```{r shapiro wilk ams, echo = FALSE}
shapiro.test(income.arq3.2000$Log.pib.real)

```

## Conclusão

```         
Os dados avaliados tanto para o  ano de 1995 quanto para ano 2000, considerando paises da Europa e America do Sul, observa-se a normalidade dos dados, observou-se na media e medianas com valores muito próximos, sem a presença de outliers. 

Também na análise dos graficos, seja de histrograma observa-se uma distribuição concentrada dos dados, com formato Gausseano e através dos gráficos de QQnorm e qqline do pacote ggppubr onde os valores estão próximos da reta, demonstrando também a normalidade dos dados. 
```

## Completude

A qualidade de dados é um quesito de extrema relevancia nas ações de
negócios. Desta forma a coleta, organização, tratamento dos dados, é um
processo delicado que requer especialização dos profissionais
envolvidos.

A completude dos dados, esta relacionada ao devido preenchimento de
dados nas variáveis, evitando que a ausência de informações que levem a
conclusões incorretas nas respectivas análises.

Vamor utilizar a função freq do summaytools para determinar a completude
das variáveis do banco:

-   Variavel pais.idx possui uma completude de 100.000 %
-   Variavel pais possui uma completude de 100.000 %
-   Variavel ano possui uma completude de 100.000 %
-   Variavel log.pib.real possui uma completude de 90.00 %
-   Variavel log.populacao possui uma completude de 90.00%
-   Variavel educ.adultos possui uma completude de 90.00%
-   Variavel fracao.pop.0_14 possui uma completude de 90.00%
-   Variavel fracao.pop.15_19 possui uma completude de 90.00%
-   Variavel fracao.pop.30_44 possui uma completude de 90.00%
-   Variavel fracao.pop. 45_59 possui uma completude de 90.00%
-   Variavel fracao.pop. 60_mais possui uma completude de 90.00%
-   Variavel idade.mediana possui uma completude de 90.00%




```{r frequência paisidx , echo = TRUE}
income.arq3 %>%  dplyr::select(pais.idx) %>% summarytools::freq()
```

```{r frequência vp , echo = TRUE}
income.arq3 %>%  dplyr::select(pais) %>% summarytools::freq()
```

```{r frequência ano , echo = TRUE}
income.arq3 %>%  dplyr::select(ano) %>% summarytools::freq()
```


```{r frequência pib , echo = TRUE}
income.arq3 %>%  dplyr::select(Log.pib.real) %>% summarytools::freq()
```

```{r frequência Lp , echo = TRUE}
income.arq3 %>%  dplyr::select(Log.populacao) %>% summarytools::freq()
```


```{r frequência edad , echo = TRUE}
income.arq3 %>%  dplyr::select(educ.adultos) %>% summarytools::freq()
```


```{r frequência fra14 , echo = TRUE}
income.arq3 %>%  dplyr::select(fracao.pop.0_14) %>% summarytools::freq()
```

```{r frequência Lp19 , echo = TRUE}
income.arq3 %>%  dplyr::select(fracao.pop.15_19) %>% summarytools::freq()
```

```{r frequência Lp44 , echo = TRUE}
income.arq3 %>%  dplyr::select(fracao.pop.30_44) %>% summarytools::freq()
```

```{r frequência Lp59 , echo = TRUE}
income.arq3 %>%  dplyr::select(fracao.pop.45_59) %>% summarytools::freq()
```

```{r frequência Lp60 , echo = TRUE}
income.arq3 %>%  dplyr::select(fracao.pop.60_mais) %>% summarytools::freq()
```

```{r frequência idmed , echo = TRUE}
income.arq3 %>%  dplyr::select(idade.mediana) %>% summarytools::freq()
```

## Imputando dados pelo Mice 

```{r regressao linear1 , echo = TRUE}
summary(lm(Log.pib.real ~ idade.mediana, data = income.arq3))
```


```{r regressao linear2 , echo = TRUE}
summary(lm(Log.pib.real ~ fracao.pop.60_mais, data = income.arq3))
```


```{r regressao linear3 , echo = TRUE}
summary(lm(Log.pib.real ~ idade.mediana + fracao.pop.60_mais, data = income.arq3))
```

Considerando as regressões acima, o modelo que utiliza as  variaveis log.pib.real, idade.mediana e fracao.pop.60_mais é o mais satisfatório. 
Dessa forma será feito a imput de dados conforme abaixo, utilizando o pacote mice. 


```{r mice , echo = TRUE}
imp <- mice(income.arq3 %>% dplyr::mutate(Log.pib.real = Log.pib.real, Log.populacao = Log.populacao, educ.adultos = educ.adultos, fracao.pop.0_14 = fracao.pop.0_14, fracao.pop.15_19 = fracao.pop.15_19,fracao.pop.30_44 = fracao.pop.30_44,fracao.pop.45_59 = fracao.pop.45_59,fracao.pop.60_mais = fracao.pop.60_mais, idade.mediana = idade.mediana), print = FALSE, m = 5, max.iter = 5 , seed = 512) 
fit <- with(data = imp, exp = lm(Log.pib.real ~ fracao.pop.60_mais, data = income.arq3)) 
est <- pool(fit)
```

